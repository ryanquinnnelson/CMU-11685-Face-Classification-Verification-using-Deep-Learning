2021-10-19 17:55:20,314 [INFO]               _---_
2021-10-19 17:55:20,314 [INFO]             /       \
2021-10-19 17:55:20,314 [INFO]            |         |
2021-10-19 17:55:20,314 [INFO]    _--_    |         |    _--_
2021-10-19 17:55:20,314 [INFO]   /__  \   \  0   0  /   /  __\
2021-10-19 17:55:20,314 [INFO]      \  \   \       /   /  /
2021-10-19 17:55:20,314 [INFO]       \  -__-       -__-  /
2021-10-19 17:55:20,314 [INFO]   |\   \    __     __    /   /|
2021-10-19 17:55:20,314 [INFO]   | \___----         ----___/ |
2021-10-19 17:55:20,314 [INFO]   \                           /
2021-10-19 17:55:20,314 [INFO]    --___--/    / \    \--___--
2021-10-19 17:55:20,314 [INFO]          /    /   \    \
2021-10-19 17:55:20,314 [INFO]    --___-    /     \    -___--
2021-10-19 17:55:20,314 [INFO]    \_    __-         -__    _/
2021-10-19 17:55:20,314 [INFO]      ----               ----
2021-10-19 17:55:20,314 [INFO] 
2021-10-19 17:55:20,314 [INFO]        O  C  T  O  P  U  S
2021-10-19 17:55:20,314 [INFO] 
2021-10-19 17:55:20,314 [INFO] Initializing octopus...
2021-10-19 17:55:20,315 [INFO] Parsing configuration from /home/ubuntu/CMU-11685-HW2P2/configs/remote/config_resnet34_r52.txt...
2021-10-19 17:55:20,315 [INFO] Initializing checkpoint handling...
2021-10-19 17:55:20,315 [INFO] Overriding delete_existing_checkpoints value. Existing checkpoints will not be deleted because checkpoint is being loaded for this run.
2021-10-19 17:55:20,315 [INFO] Initializing criterion handling...
2021-10-19 17:55:20,315 [INFO] Initializing device handling...
2021-10-19 17:55:20,315 [INFO] Initializing dataloader handling...
2021-10-19 17:55:20,315 [INFO] Initializing optimizer handling...
2021-10-19 17:55:20,315 [INFO] Initializing output handling...
2021-10-19 17:55:20,315 [INFO] Initializing scheduler handling...
2021-10-19 17:55:20,315 [INFO] Initializing stats handling...
2021-10-19 17:55:20,315 [INFO] Initializing phase handling...
2021-10-19 17:55:20,315 [INFO] Initializing dataset handling...
2021-10-19 17:55:20,316 [INFO] Initializing model handling...
2021-10-19 17:55:20,316 [INFO] octopus initialization is complete.
2021-10-19 17:55:20,316 [INFO] octopus is setting up the environment...
2021-10-19 17:55:20,316 [INFO] Setting up wandb connection...
2021-10-19 17:55:20,316 [INFO] Directory already exists:/home/ubuntu/.
2021-10-19 17:55:20,316 [INFO] Installing wandb...
2021-10-19 17:55:22,319 [INFO] Looking in indexes: https://pypi.org/simple, https://pip.repos.neuron.amazonaws.com
Requirement already satisfied: wandb==0.10.8 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (0.10.8)
Requirement already satisfied: configparser>=3.8.1 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from wandb==0.10.8) (5.0.2)
Requirement already satisfied: shortuuid>=0.5.0 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from wandb==0.10.8) (1.0.1)
Requirement already satisfied: psutil>=5.0.0 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from wandb==0.10.8) (5.8.0)
Requirement already satisfied: GitPython>=1.0.0 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from wandb==0.10.8) (3.1.24)
Requirement already satisfied: docker-pycreds>=0.4.0 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from wandb==0.10.8) (0.4.0)
Requirement already satisfied: PyYAML in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from wandb==0.10.8) (5.4.1)
Requirement already satisfied: promise<3,>=2.0 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from wandb==0.10.8) (2.3)
Requirement already satisfied: python-dateutil>=2.6.1 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from wandb==0.10.8) (2.8.1)
Requirement already satisfied: protobuf>=3.12.0 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from wandb==0.10.8) (3.18.1)
Requirement already satisfied: requests<3,>=2.0.0 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from wandb==0.10.8) (2.25.1)
Requirement already satisfied: watchdog>=0.8.3 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from wandb==0.10.8) (1.0.2)
Requirement already satisfied: sentry-sdk>=0.4.0 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from wandb==0.10.8) (1.4.3)
Requirement already satisfied: Click>=7.0 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from wandb==0.10.8) (7.1.2)
Requirement already satisfied: subprocess32>=3.5.3 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from wandb==0.10.8) (3.5.4)
Requirement already satisfied: six>=1.13.0 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from wandb==0.10.8) (1.15.0)
Requirement already satisfied: typing-extensions>=3.7.4.3 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from GitPython>=1.0.0->wandb==0.10.8) (3.7.4.3)
Requirement already satisfied: gitdb<5,>=4.0.1 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from GitPython>=1.0.0->wandb==0.10.8) (4.0.7)
Requirement already satisfied: smmap<5,>=3.0.1 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from gitdb<5,>=4.0.1->GitPython>=1.0.0->wandb==0.10.8) (4.0.0)
Requirement already satisfied: certifi>=2017.4.17 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from requests<3,>=2.0.0->wandb==0.10.8) (2021.5.30)
Requirement already satisfied: chardet<5,>=3.0.2 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from requests<3,>=2.0.0->wandb==0.10.8) (4.0.0)
Requirement already satisfied: idna<3,>=2.5 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from requests<3,>=2.0.0->wandb==0.10.8) (2.10)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from requests<3,>=2.0.0->wandb==0.10.8) (1.26.7)

2021-10-19 17:55:22,319 [INFO] Logging into wandb...
2021-10-19 17:55:22,730 [INFO] setting login settings: {}
2021-10-19 17:55:22,925 [INFO] Initializing wandb...
2021-10-19 17:55:22,927 [INFO] setting login settings: {}
2021-10-19 17:55:23,679 [INFO] Setting up kaggle connection...
2021-10-19 17:55:23,679 [INFO] Installing kaggle...
2021-10-19 17:55:25,293 [INFO] Looking in indexes: https://pypi.org/simple, https://pip.repos.neuron.amazonaws.com
Requirement already satisfied: kaggle in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (1.5.12)
Requirement already satisfied: certifi in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from kaggle) (2021.5.30)
Requirement already satisfied: python-slugify in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from kaggle) (5.0.2)
Requirement already satisfied: urllib3 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from kaggle) (1.26.7)
Requirement already satisfied: requests in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from kaggle) (2.25.1)
Requirement already satisfied: six>=1.10 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from kaggle) (1.15.0)
Requirement already satisfied: python-dateutil in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from kaggle) (2.8.1)
Requirement already satisfied: tqdm in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from kaggle) (4.56.0)
Requirement already satisfied: text-unidecode>=1.3 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from python-slugify->kaggle) (1.3)
Requirement already satisfied: idna<3,>=2.5 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from requests->kaggle) (2.10)
Requirement already satisfied: chardet<5,>=3.0.2 in ./anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages (from requests->kaggle) (4.0.0)

2021-10-19 17:55:25,294 [INFO] Setting up kaggle directories...
2021-10-19 17:55:25,294 [INFO] Directory already exists:/home/ubuntu/.kaggle.
2021-10-19 17:55:25,294 [INFO] Directory already exists:/home/ubuntu/content/.
2021-10-19 17:55:25,294 [INFO] Reading kaggle token from /home/ubuntu/kaggle.json...
2021-10-19 17:55:25,295 [INFO] Writing kaggle token to /home/ubuntu/.kaggle...
2021-10-19 17:55:25,295 [INFO] Securing kaggle token...
2021-10-19 17:55:25,308 [INFO] 
2021-10-19 17:55:25,308 [INFO] Configuring content directory for kaggle...
2021-10-19 17:55:25,644 [INFO] - path is now set to: /home/ubuntu/content/

2021-10-19 17:55:25,645 [INFO] Preparing checkpoint directory...
2021-10-19 17:55:25,645 [INFO] Directory already exists:/data/checkpoints.
2021-10-19 17:55:25,645 [INFO] Preparing output directory...
2021-10-19 17:55:25,645 [INFO] Directory already exists:/home/ubuntu/output.
2021-10-19 17:55:25,645 [INFO] Setting up device...
2021-10-19 17:55:25,689 [INFO] Gpu detected. device is set to cuda.
2021-10-19 17:55:25,690 [INFO] DataLoader settings for training dataset:{'shuffle': True, 'batch_size': 256, 'num_workers': 8, 'pin_memory': True}
2021-10-19 17:55:25,690 [INFO] DataLoader settings for validation dataset:{'shuffle': False, 'batch_size': 256, 'num_workers': 8, 'pin_memory': True}
2021-10-19 17:55:25,690 [INFO] DataLoader settings for test dataset:{'shuffle': False, 'batch_size': 256, 'num_workers': 8, 'pin_memory': True}
2021-10-19 17:55:25,690 [INFO] octopus has finished setting up the environment.
2021-10-19 17:55:25,690 [INFO] octopus is downloading data...
2021-10-19 17:55:25,690 [INFO] Competition files are already downloaded.
2021-10-19 17:55:25,690 [INFO] Unzipping competition files...
2021-10-19 17:55:25,691 [INFO] Found the following zipped files:[].
2021-10-19 17:55:25,691 [INFO] Removing zip files after extracting contents...
2021-10-19 17:55:25,691 [INFO] octopus has finished downloading data.
2021-10-19 17:55:25,691 [INFO] octopus is running the pipeline...
2021-10-19 17:55:25,691 [INFO] Initializing model...
2021-10-19 17:55:26,035 [INFO] Model initialized:
Resnet34_v3(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(3, 3), bias=False)
  (layers): Sequential(
    (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(3, 3), bias=False)
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): ResidualBlock3(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (blocks): Sequential(
        (0): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (shortcut): Identity()
      (activate): ReLU(inplace=True)
    )
    (4): ResidualBlock3(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (blocks): Sequential(
        (0): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (shortcut): Identity()
      (activate): ReLU(inplace=True)
    )
    (5): ResidualBlock3(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (blocks): Sequential(
        (0): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (shortcut): Identity()
      (activate): ReLU(inplace=True)
    )
    (6): ResidualBlock3(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (blocks): Sequential(
        (0): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (4): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (activate): ReLU(inplace=True)
    )
    (7): ResidualBlock3(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (blocks): Sequential(
        (0): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (4): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (shortcut): Identity()
      (activate): ReLU(inplace=True)
    )
    (8): ResidualBlock3(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (blocks): Sequential(
        (0): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (4): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (shortcut): Identity()
      (activate): ReLU(inplace=True)
    )
    (9): ResidualBlock3(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (blocks): Sequential(
        (0): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (4): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (shortcut): Identity()
      (activate): ReLU(inplace=True)
    )
    (10): ResidualBlock3(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (blocks): Sequential(
        (0): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (4): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (activate): ReLU(inplace=True)
    )
    (11): ResidualBlock3(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (blocks): Sequential(
        (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (4): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (shortcut): Identity()
      (activate): ReLU(inplace=True)
    )
    (12): ResidualBlock3(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (blocks): Sequential(
        (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (4): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (shortcut): Identity()
      (activate): ReLU(inplace=True)
    )
    (13): ResidualBlock3(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (blocks): Sequential(
        (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (4): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (shortcut): Identity()
      (activate): ReLU(inplace=True)
    )
    (14): ResidualBlock3(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (blocks): Sequential(
        (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (4): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (shortcut): Identity()
      (activate): ReLU(inplace=True)
    )
    (15): ResidualBlock3(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (blocks): Sequential(
        (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (4): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (shortcut): Identity()
      (activate): ReLU(inplace=True)
    )
    (16): ResidualBlock3(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (blocks): Sequential(
        (0): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (4): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (activate): ReLU(inplace=True)
    )
    (17): ResidualBlock3(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (blocks): Sequential(
        (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (4): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (shortcut): Identity()
      (activate): ReLU(inplace=True)
    )
    (18): ResidualBlock3(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (blocks): Sequential(
        (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (4): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (shortcut): Identity()
      (activate): ReLU(inplace=True)
    )
    (19): AdaptiveAvgPool2d(output_size=(1, 1))
    (20): Flatten(start_dim=1, end_dim=-1)
  )
  (linear): Sequential(
    (0): Linear(in_features=512, out_features=4000, bias=True)
  )
  (linear_feat_dim): Linear(in_features=512, out_features=2, bias=True)
  (activation): ReLU(inplace=True)
)
2021-10-19 17:55:29,450 [INFO] Criterion is set:CrossEntropyLoss().
2021-10-19 17:55:29,450 [INFO] Optimizer initialized:
SGD (
Parameter Group 0
    dampening: 0
    lr: 0.1
    momentum: 0.5
    nesterov: False
    weight_decay: 5e-05
)
2021-10-19 17:55:29,450 [INFO] Scheduler initialized:
<torch.optim.lr_scheduler.ReduceLROnPlateau object at 0x7fbad01e3390>
{'factor': 0.5, 'min_lrs': [0], 'patience': 3.0, 'verbose': 'True', 'cooldown': 0, 'cooldown_counter': 0, 'mode': 'max', 'threshold': 0.0001, 'threshold_mode': 'rel', 'best': -inf, 'num_bad_epochs': 0, 'mode_worse': -inf, 'eps': 1e-08, 'last_epoch': 0}
2021-10-19 17:55:29,450 [INFO] Loading data...
2021-10-19 17:55:30,847 [INFO] Loaded 380638 images as training data.
2021-10-19 17:55:30,847 [INFO] Writing class_to_idx mapping to /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-19 17:55:30,852 [INFO] Normalizing validation data to match normalization of training data...
2021-10-19 17:55:30,938 [INFO] Loaded 8000 images as validation data.
2021-10-19 17:55:30,938 [INFO] Normalizing test data to match normalization of training data...
2021-10-19 17:55:30,964 [INFO] Loaded 8000 images as test data.
2021-10-19 17:55:30,964 [INFO] Loading training phase...
2021-10-19 17:55:30,964 [INFO] Loading evaluation phase...
2021-10-19 17:55:30,964 [INFO] Loading testing phase...
2021-10-19 17:55:30,964 [INFO] Loading checkpoint from /data/checkpoints/Resnet34-Run-052.checkpoint.48.pt...
2021-10-19 17:55:31,100 [INFO] Reporting previous stats...
2021-10-19 17:55:31,105 [INFO] Running epoch 49/70 of training...
2021-10-19 19:00:33,906 [INFO] Running epoch 49/70 of evaluation...
2021-10-19 19:00:51,693 [INFO] Running epoch 49/70 of testing...
2021-10-19 19:01:09,836 [INFO] NumExpr defaulting to 8 threads.
2021-10-19 19:01:09,842 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-19 19:01:10,421 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch49.20211019.19.01.10.output.csv...
2021-10-19 19:01:10,433 [INFO] Collecting stats for epoch 49...
2021-10-19 19:01:10,441 [INFO] stats:{'epoch': 49, 'runtime': 3939.3278975486755, 'train_loss': 0.04839999883334831, 'val_loss': 1.0980382300913334, 'val_acc': 0.784625}
2021-10-19 19:01:10,442 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.49.pt...
2021-10-19 19:01:10,676 [INFO] Checking early stopping criteria...
2021-10-19 19:01:10,676 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-19 19:01:35,350 [INFO] Gathered metrics for epoch 49 from wandb:
                name  epoch   val_acc
48   Resnet18-Run-10   49.0  0.537875
48   Resnet18-Run-11   49.0  0.543500
48  Resnet34-Run-050   49.0  0.580625
48   Resnet50-Run-03   49.0  0.582625
48   Resnet18-Run-08   49.0  0.612250
48  Resnet34-Run-051   49.0  0.775875
48  Resnet34-Run-052   49.0  0.777625
2021-10-19 19:01:35,418 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-19 19:01:35,418 [INFO] Early stopping criteria is not met.
2021-10-19 19:01:35,418 [INFO] Running epoch 50/70 of training...
2021-10-19 20:06:18,486 [INFO] Running epoch 50/70 of evaluation...
2021-10-19 20:06:34,932 [INFO] Running epoch 50/70 of testing...
2021-10-19 20:06:51,434 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-19 20:06:52,020 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch50.20211019.20.06.52.output.csv...
2021-10-19 20:06:52,031 [INFO] Collecting stats for epoch 50...
2021-10-19 20:06:52,040 [INFO] stats:{'epoch': 50, 'runtime': 3916.6125588417053, 'train_loss': 0.04752021670346502, 'val_loss': 1.0771922580897808, 'val_acc': 0.78725}
2021-10-19 20:06:52,041 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.50.pt...
2021-10-19 20:06:52,278 [INFO] Checking early stopping criteria...
2021-10-19 20:06:52,279 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-19 20:07:16,866 [INFO] Gathered metrics for epoch 50 from wandb:
                name  epoch   val_acc
49   Resnet18-Run-10   50.0  0.539000
49   Resnet18-Run-11   50.0  0.545375
49  Resnet34-Run-050   50.0  0.578250
49   Resnet50-Run-03   50.0  0.579875
49   Resnet18-Run-08   50.0  0.613000
49  Resnet34-Run-051   50.0  0.772125
2021-10-19 20:07:16,871 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-19 20:07:16,871 [INFO] Early stopping criteria is not met.
2021-10-19 20:07:16,871 [INFO] Running epoch 51/70 of training...
2021-10-19 21:12:00,396 [INFO] Running epoch 51/70 of evaluation...
2021-10-19 21:12:17,856 [INFO] Running epoch 51/70 of testing...
2021-10-19 21:12:35,484 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-19 21:12:36,069 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch51.20211019.21.12.36.output.csv...
2021-10-19 21:12:36,079 [INFO] Collecting stats for epoch 51...
2021-10-19 21:12:36,088 [INFO] stats:{'epoch': 51, 'runtime': 3919.20761179924, 'train_loss': 0.04681288379807559, 'val_loss': 1.0921010579913855, 'val_acc': 0.78375}
2021-10-19 21:12:36,089 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.51.pt...
2021-10-19 21:12:36,326 [INFO] Checking early stopping criteria...
2021-10-19 21:12:36,327 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-19 21:13:00,331 [INFO] Gathered metrics for epoch 51 from wandb:
                name  epoch   val_acc
50  Resnet34-Run-050   51.0  0.579000
50  Resnet34-Run-051   51.0  0.774625
50  Resnet34-Run-051   51.0  0.774625
2021-10-19 21:13:00,336 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-19 21:13:00,336 [INFO] Early stopping criteria is not met.
2021-10-19 21:13:00,336 [INFO] Running epoch 52/70 of training...
2021-10-19 22:17:36,198 [INFO] Running epoch 52/70 of evaluation...
2021-10-19 22:17:52,732 [INFO] Running epoch 52/70 of testing...
2021-10-19 22:18:09,547 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-19 22:18:10,145 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch52.20211019.22.18.10.output.csv...
2021-10-19 22:18:10,155 [INFO] Collecting stats for epoch 52...
2021-10-19 22:18:10,164 [INFO] stats:{'epoch': 52, 'runtime': 3909.8189220428467, 'train_loss': 0.04608276037583234, 'val_loss': 1.0917100887745619, 'val_acc': 0.78475}
2021-10-19 22:18:10,165 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.52.pt...
2021-10-19 22:18:10,402 [INFO] Checking early stopping criteria...
2021-10-19 22:18:10,402 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-19 22:18:36,306 [INFO] Gathered metrics for epoch 52 from wandb:
                name  epoch   val_acc
51  Resnet34-Run-050   52.0  0.578250
51  Resnet34-Run-051   52.0  0.772375
51  Resnet34-Run-051   52.0  0.772375
2021-10-19 22:18:36,311 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-19 22:18:36,311 [INFO] Early stopping criteria is not met.
2021-10-19 22:18:36,311 [INFO] Running epoch 53/70 of training...
2021-10-19 23:23:10,817 [INFO] Running epoch 53/70 of evaluation...
2021-10-19 23:23:28,359 [INFO] Running epoch 53/70 of testing...
2021-10-19 23:23:46,010 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-19 23:23:46,597 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch53.20211019.23.23.46.output.csv...
2021-10-19 23:23:46,608 [INFO] Collecting stats for epoch 53...
2021-10-19 23:23:46,617 [INFO] stats:{'epoch': 53, 'runtime': 3910.2962868213654, 'train_loss': 0.035587360111654566, 'val_loss': 1.043774038553238, 'val_acc': 0.79375}
2021-10-19 23:23:46,618 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.53.pt...
2021-10-19 23:23:46,862 [INFO] Checking early stopping criteria...
2021-10-19 23:23:46,862 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-19 23:24:11,424 [INFO] Gathered metrics for epoch 53 from wandb:
                name  epoch   val_acc
52  Resnet34-Run-050   53.0  0.583375
52  Resnet34-Run-051   53.0  0.775500
52  Resnet34-Run-051   53.0  0.775500
52  Resnet34-Run-052   53.0  0.793750
2021-10-19 23:24:11,429 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-19 23:24:11,429 [INFO] Early stopping criteria is not met.
2021-10-19 23:24:11,429 [INFO] Running epoch 54/70 of training...
2021-10-20 00:29:15,524 [INFO] Running epoch 54/70 of evaluation...
2021-10-20 00:29:32,942 [INFO] Running epoch 54/70 of testing...
2021-10-20 00:29:50,483 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-20 00:29:51,076 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch54.20211020.00.29.51.output.csv...
2021-10-20 00:29:51,087 [INFO] Collecting stats for epoch 54...
2021-10-20 00:29:51,096 [INFO] stats:{'epoch': 54, 'runtime': 3939.6575903892517, 'train_loss': 0.03257827790142128, 'val_loss': 1.0371678434312344, 'val_acc': 0.795125}
2021-10-20 00:29:51,097 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.54.pt...
2021-10-20 00:29:51,331 [INFO] Checking early stopping criteria...
2021-10-20 00:29:51,332 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-20 00:30:14,763 [INFO] Gathered metrics for epoch 54 from wandb:
                name  epoch   val_acc
53  Resnet34-Run-050   54.0  0.582875
53  Resnet34-Run-051   54.0  0.776500
53  Resnet34-Run-051   54.0  0.776500
2021-10-20 00:30:14,768 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-20 00:30:14,769 [INFO] Early stopping criteria is not met.
2021-10-20 00:30:14,769 [INFO] Running epoch 55/70 of training...
2021-10-20 01:35:08,313 [INFO] Running epoch 55/70 of evaluation...
2021-10-20 01:35:25,574 [INFO] Running epoch 55/70 of testing...
2021-10-20 01:35:42,993 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-20 01:35:43,588 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch55.20211020.01.35.43.output.csv...
2021-10-20 01:35:43,598 [INFO] Collecting stats for epoch 55...
2021-10-20 01:35:43,608 [INFO] stats:{'epoch': 55, 'runtime': 3928.829664707184, 'train_loss': 0.03225381075947595, 'val_loss': 1.0284688174724579, 'val_acc': 0.794375}
2021-10-20 01:35:43,608 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.55.pt...
2021-10-20 01:35:43,843 [INFO] Checking early stopping criteria...
2021-10-20 01:35:43,843 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-20 01:36:10,943 [INFO] Gathered metrics for epoch 55 from wandb:
                name  epoch   val_acc
54  Resnet34-Run-050   55.0  0.583500
54  Resnet34-Run-051   55.0  0.775375
54  Resnet34-Run-051   55.0  0.775375
2021-10-20 01:36:10,947 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-20 01:36:10,947 [INFO] Early stopping criteria is not met.
2021-10-20 01:36:10,947 [INFO] Running epoch 56/70 of training...
2021-10-20 02:41:17,683 [INFO] Running epoch 56/70 of evaluation...
2021-10-20 02:41:35,190 [INFO] Running epoch 56/70 of testing...
2021-10-20 02:41:52,819 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-20 02:41:53,405 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch56.20211020.02.41.53.output.csv...
2021-10-20 02:41:53,415 [INFO] Collecting stats for epoch 56...
2021-10-20 02:41:53,425 [INFO] stats:{'epoch': 56, 'runtime': 3942.4679021835327, 'train_loss': 0.031613851690109974, 'val_loss': 1.027688292786479, 'val_acc': 0.795625}
2021-10-20 02:41:53,426 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.56.pt...
2021-10-20 02:41:53,660 [INFO] Checking early stopping criteria...
2021-10-20 02:41:53,661 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-20 02:42:17,400 [INFO] Gathered metrics for epoch 56 from wandb:
                name  epoch   val_acc
55  Resnet34-Run-050   56.0  0.585125
55  Resnet34-Run-051   56.0  0.774250
55  Resnet34-Run-051   56.0  0.776750
2021-10-20 02:42:17,405 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-20 02:42:17,405 [INFO] Early stopping criteria is not met.
2021-10-20 02:42:17,405 [INFO] Running epoch 57/70 of training...
2021-10-20 03:47:40,224 [INFO] Running epoch 57/70 of evaluation...
2021-10-20 03:47:57,595 [INFO] Running epoch 57/70 of testing...
2021-10-20 03:48:15,167 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-20 03:48:15,763 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch57.20211020.03.48.15.output.csv...
2021-10-20 03:48:15,774 [INFO] Collecting stats for epoch 57...
2021-10-20 03:48:15,783 [INFO] stats:{'epoch': 57, 'runtime': 3958.3682556152344, 'train_loss': 0.03128515639941746, 'val_loss': 1.023254245519638, 'val_acc': 0.796875}
2021-10-20 03:48:15,784 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.57.pt...
2021-10-20 03:48:16,016 [INFO] Checking early stopping criteria...
2021-10-20 03:48:16,016 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-20 03:48:40,057 [INFO] Gathered metrics for epoch 57 from wandb:
                name  epoch   val_acc
56  Resnet34-Run-051   57.0  0.776875
56  Resnet34-Run-051   57.0  0.777500
2021-10-20 03:48:40,062 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-20 03:48:40,062 [INFO] Early stopping criteria is not met.
2021-10-20 03:48:40,062 [INFO] Running epoch 58/70 of training...
2021-10-20 04:53:40,603 [INFO] Running epoch 58/70 of evaluation...
2021-10-20 04:53:58,043 [INFO] Running epoch 58/70 of testing...
2021-10-20 04:54:15,564 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-20 04:54:16,161 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch58.20211020.04.54.16.output.csv...
2021-10-20 04:54:16,171 [INFO] Collecting stats for epoch 58...
2021-10-20 04:54:16,181 [INFO] stats:{'epoch': 58, 'runtime': 3936.1091220378876, 'train_loss': 0.030022894555894457, 'val_loss': 1.0210412163287401, 'val_acc': 0.7945}
2021-10-20 04:54:16,181 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.58.pt...
2021-10-20 04:54:16,415 [INFO] Checking early stopping criteria...
2021-10-20 04:54:16,415 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-20 04:54:39,556 [INFO] Gathered metrics for epoch 58 from wandb:
                name  epoch  val_acc
57  Resnet34-Run-051   58.0    0.774
2021-10-20 04:54:39,561 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-20 04:54:39,561 [INFO] Early stopping criteria is not met.
2021-10-20 04:54:39,562 [INFO] Running epoch 59/70 of training...
2021-10-20 05:59:44,501 [INFO] Running epoch 59/70 of evaluation...
2021-10-20 06:00:02,053 [INFO] Running epoch 59/70 of testing...
2021-10-20 06:00:19,633 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-20 06:00:20,233 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch59.20211020.06.00.20.output.csv...
2021-10-20 06:00:20,243 [INFO] Collecting stats for epoch 59...
2021-10-20 06:00:20,253 [INFO] stats:{'epoch': 59, 'runtime': 3940.68154835701, 'train_loss': 0.02981494046765221, 'val_loss': 1.0253677051514387, 'val_acc': 0.79575}
2021-10-20 06:00:20,253 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.59.pt...
2021-10-20 06:00:20,487 [INFO] Checking early stopping criteria...
2021-10-20 06:00:20,488 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-20 06:00:46,119 [INFO] Gathered metrics for epoch 59 from wandb:
                name  epoch   val_acc
58  Resnet34-Run-051   59.0  0.774875
2021-10-20 06:00:46,124 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-20 06:00:46,124 [INFO] Early stopping criteria is not met.
2021-10-20 06:00:46,124 [INFO] Running epoch 60/70 of training...
2021-10-20 07:05:52,247 [INFO] Running epoch 60/70 of evaluation...
2021-10-20 07:06:09,438 [INFO] Running epoch 60/70 of testing...
2021-10-20 07:06:26,672 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-20 07:06:27,263 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch60.20211020.07.06.27.output.csv...
2021-10-20 07:06:27,273 [INFO] Collecting stats for epoch 60...
2021-10-20 07:06:27,282 [INFO] stats:{'epoch': 60, 'runtime': 3941.148745059967, 'train_loss': 0.030070652476265756, 'val_loss': 1.0260021202266216, 'val_acc': 0.793125}
2021-10-20 07:06:27,283 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.60.pt...
2021-10-20 07:06:27,516 [INFO] Checking early stopping criteria...
2021-10-20 07:06:27,517 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-20 07:06:51,960 [INFO] Gathered metrics for epoch 60 from wandb:
                name  epoch   val_acc
59  Resnet34-Run-051   60.0  0.775375
2021-10-20 07:06:51,964 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-20 07:06:51,964 [INFO] Early stopping criteria is not met.
2021-10-20 07:06:51,964 [INFO] Running epoch 61/70 of training...
2021-10-20 08:11:41,091 [INFO] Running epoch 61/70 of evaluation...
2021-10-20 08:11:58,324 [INFO] Running epoch 61/70 of testing...
2021-10-20 08:12:15,724 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-20 08:12:16,310 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch61.20211020.08.12.16.output.csv...
2021-10-20 08:12:16,321 [INFO] Collecting stats for epoch 61...
2021-10-20 08:12:16,330 [INFO] stats:{'epoch': 61, 'runtime': 3924.3561732769012, 'train_loss': 0.029018630090757714, 'val_loss': 1.0186850614845753, 'val_acc': 0.79525}
2021-10-20 08:12:16,331 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.61.pt...
2021-10-20 08:12:16,551 [INFO] Checking early stopping criteria...
2021-10-20 08:12:16,551 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-20 08:12:43,008 [INFO] Gathered metrics for epoch 61 from wandb:
                name  epoch  val_acc
60  Resnet34-Run-051   61.0  0.77475
2021-10-20 08:12:43,012 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-20 08:12:43,012 [INFO] Early stopping criteria is not met.
2021-10-20 08:12:43,012 [INFO] Running epoch 62/70 of training...
2021-10-20 09:17:39,520 [INFO] Running epoch 62/70 of evaluation...
2021-10-20 09:17:56,804 [INFO] Running epoch 62/70 of testing...
2021-10-20 09:18:14,244 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-20 09:18:14,832 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch62.20211020.09.18.14.output.csv...
2021-10-20 09:18:14,842 [INFO] Collecting stats for epoch 62...
2021-10-20 09:18:14,852 [INFO] stats:{'epoch': 62, 'runtime': 3931.829927921295, 'train_loss': 0.02658910190820614, 'val_loss': 1.0075801201164722, 'val_acc': 0.797625}
2021-10-20 09:18:14,852 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.62.pt...
2021-10-20 09:18:15,087 [INFO] Checking early stopping criteria...
2021-10-20 09:18:15,087 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-20 09:18:38,475 [INFO] Gathered metrics for epoch 62 from wandb:
                name  epoch   val_acc
61  Resnet34-Run-051   62.0  0.775375
2021-10-20 09:18:38,479 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-20 09:18:38,479 [INFO] Early stopping criteria is not met.
2021-10-20 09:18:38,480 [INFO] Running epoch 63/70 of training...
2021-10-20 10:23:12,775 [INFO] Running epoch 63/70 of evaluation...
2021-10-20 10:23:30,040 [INFO] Running epoch 63/70 of testing...
2021-10-20 10:23:47,453 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-20 10:23:48,043 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch63.20211020.10.23.48.output.csv...
2021-10-20 10:23:48,053 [INFO] Collecting stats for epoch 63...
2021-10-20 10:23:48,062 [INFO] stats:{'epoch': 63, 'runtime': 3909.5736796855927, 'train_loss': 0.025977727439738033, 'val_loss': 1.0007024742662907, 'val_acc': 0.79775}
2021-10-20 10:23:48,063 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.63.pt...
2021-10-20 10:23:48,284 [INFO] Checking early stopping criteria...
2021-10-20 10:23:48,285 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-20 10:24:12,106 [INFO] Gathered metrics for epoch 63 from wandb:
                name  epoch  val_acc
62  Resnet34-Run-051   63.0  0.77675
2021-10-20 10:24:12,111 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-20 10:24:12,111 [INFO] Early stopping criteria is not met.
2021-10-20 10:24:12,111 [INFO] Running epoch 64/70 of training...
2021-10-20 11:29:22,354 [INFO] Running epoch 64/70 of evaluation...
2021-10-20 11:29:39,553 [INFO] Running epoch 64/70 of testing...
2021-10-20 11:29:57,103 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-20 11:29:57,697 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch64.20211020.11.29.57.output.csv...
2021-10-20 11:29:57,707 [INFO] Collecting stats for epoch 64...
2021-10-20 11:29:57,716 [INFO] stats:{'epoch': 64, 'runtime': 3945.595963001251, 'train_loss': 0.02536926093863896, 'val_loss': 1.0034862160682678, 'val_acc': 0.798625}
2021-10-20 11:29:57,717 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.64.pt...
2021-10-20 11:29:57,940 [INFO] Checking early stopping criteria...
2021-10-20 11:29:57,941 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-20 11:30:22,939 [INFO] Gathered metrics for epoch 64 from wandb:
                name  epoch  val_acc
63  Resnet34-Run-051   64.0  0.77525
2021-10-20 11:30:22,944 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-20 11:30:22,944 [INFO] Early stopping criteria is not met.
2021-10-20 11:30:22,944 [INFO] Running epoch 65/70 of training...
2021-10-20 12:35:37,711 [INFO] Running epoch 65/70 of evaluation...
2021-10-20 12:35:55,009 [INFO] Running epoch 65/70 of testing...
2021-10-20 12:36:12,379 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-20 12:36:12,963 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch65.20211020.12.36.12.output.csv...
2021-10-20 12:36:12,973 [INFO] Collecting stats for epoch 65...
2021-10-20 12:36:12,982 [INFO] stats:{'epoch': 65, 'runtime': 3950.02916264534, 'train_loss': 0.02516257655496816, 'val_loss': 1.002510940656066, 'val_acc': 0.797375}
2021-10-20 12:36:12,983 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.65.pt...
2021-10-20 12:36:13,211 [INFO] Checking early stopping criteria...
2021-10-20 12:36:13,211 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-20 12:36:37,763 [INFO] Gathered metrics for epoch 65 from wandb:
                name  epoch  val_acc
64  Resnet34-Run-051   65.0  0.77575
2021-10-20 12:36:37,768 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-20 12:36:37,768 [INFO] Early stopping criteria is not met.
2021-10-20 12:36:37,768 [INFO] Running epoch 66/70 of training...
2021-10-20 13:41:54,564 [INFO] Running epoch 66/70 of evaluation...
2021-10-20 13:42:11,956 [INFO] Running epoch 66/70 of testing...
2021-10-20 13:42:29,496 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-20 13:42:30,083 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch66.20211020.13.42.30.output.csv...
2021-10-20 13:42:30,093 [INFO] Collecting stats for epoch 66...
2021-10-20 13:42:30,102 [INFO] stats:{'epoch': 66, 'runtime': 3952.3250205516815, 'train_loss': 0.02554993568490577, 'val_loss': 1.0040053240954876, 'val_acc': 0.79825}
2021-10-20 13:42:30,103 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.66.pt...
2021-10-20 13:42:30,326 [INFO] Checking early stopping criteria...
2021-10-20 13:42:30,326 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-20 13:42:54,498 [INFO] Gathered metrics for epoch 66 from wandb:
                name  epoch   val_acc
65  Resnet34-Run-051   66.0  0.774375
2021-10-20 13:42:54,503 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-20 13:42:54,503 [INFO] Early stopping criteria is not met.
2021-10-20 13:42:54,503 [INFO] Running epoch 67/70 of training...
2021-10-20 14:47:27,571 [INFO] Running epoch 67/70 of evaluation...
2021-10-20 14:47:44,032 [INFO] Running epoch 67/70 of testing...
2021-10-20 14:48:00,693 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-20 14:48:01,280 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch67.20211020.14.48.01.output.csv...
2021-10-20 14:48:01,290 [INFO] Collecting stats for epoch 67...
2021-10-20 14:48:01,300 [INFO] stats:{'epoch': 67, 'runtime': 3906.7876262664795, 'train_loss': 0.024829892880047177, 'val_loss': 1.003795025870204, 'val_acc': 0.799}
2021-10-20 14:48:01,300 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.67.pt...
2021-10-20 14:48:01,524 [INFO] Checking early stopping criteria...
2021-10-20 14:48:01,524 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-20 14:48:26,622 [INFO] Gathered metrics for epoch 67 from wandb:
                name  epoch   val_acc
66  Resnet34-Run-051   67.0  0.776625
2021-10-20 14:48:26,627 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-20 14:48:26,627 [INFO] Early stopping criteria is not met.
2021-10-20 14:48:26,627 [INFO] Running epoch 68/70 of training...
2021-10-20 15:53:45,495 [INFO] Running epoch 68/70 of evaluation...
2021-10-20 15:54:02,986 [INFO] Running epoch 68/70 of testing...
2021-10-20 15:54:20,570 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-20 15:54:21,162 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch68.20211020.15.54.21.output.csv...
2021-10-20 15:54:21,172 [INFO] Collecting stats for epoch 68...
2021-10-20 15:54:21,181 [INFO] stats:{'epoch': 68, 'runtime': 3954.5450637340546, 'train_loss': 0.025150080316680624, 'val_loss': 1.001461772248149, 'val_acc': 0.7985}
2021-10-20 15:54:21,182 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.68.pt...
2021-10-20 15:54:21,402 [INFO] Checking early stopping criteria...
2021-10-20 15:54:21,403 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-20 15:54:44,726 [INFO] Gathered metrics for epoch 68 from wandb:
                name  epoch  val_acc
67  Resnet34-Run-051   68.0  0.77625
2021-10-20 15:54:44,731 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-20 15:54:44,731 [INFO] Early stopping criteria is not met.
2021-10-20 15:54:44,731 [INFO] Running epoch 69/70 of training...
2021-10-20 16:59:44,376 [INFO] Running epoch 69/70 of evaluation...
2021-10-20 17:00:01,653 [INFO] Running epoch 69/70 of testing...
2021-10-20 17:00:19,147 [INFO] Reading class_to_idx mapping from /home/ubuntu/content/competitions/idl-fall21-hw2p2s1-face-classification/class_to_idx.json...
2021-10-20 17:00:19,743 [INFO] Saving test output to /home/ubuntu/output/Resnet34-Run-052.epoch69.20211020.17.00.19.output.csv...
2021-10-20 17:00:19,753 [INFO] Collecting stats for epoch 69...
2021-10-20 17:00:19,762 [INFO] stats:{'epoch': 69, 'runtime': 3935.0217740535736, 'train_loss': 0.024870304235463263, 'val_loss': 0.9966169092804193, 'val_acc': 0.79975}
2021-10-20 17:00:19,763 [INFO] Saving checkpoint to /data/checkpoints/Resnet34-Run-052.checkpoint.69.pt...
2021-10-20 17:00:19,985 [INFO] Checking early stopping criteria...
2021-10-20 17:00:19,985 [INFO] Checking whether comparison metric for current model is worse than the best model so far...
2021-10-20 17:00:45,218 [INFO] Gathered metrics for epoch 69 from wandb:
                name  epoch  val_acc
68  Resnet34-Run-051   69.0    0.777
2021-10-20 17:00:45,222 [INFO] Current model has the best value for the comparison metric for this epoch.
2021-10-20 17:00:45,223 [INFO] Early stopping criteria is not met.
2021-10-20 17:00:45,223 [INFO] Running epoch 70/70 of training...
